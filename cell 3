# Cell 3

from tensorflow.keras.preprocessing.image import ImageDataGenerator

# Create the generator for the training data (rescaling only)
train_image_generator = ImageDataGenerator(rescale=1./255) # Rescale from 0-255 to 0-1
validation_image_generator = ImageDataGenerator(rescale=1./255)
test_image_generator = ImageDataGenerator(rescale=1./255)

# Flow images from directories
train_data_gen = train_image_generator.flow_from_directory(
    directory=train_dir,
    target_size=(IMG_HEIGHT, IMG_WIDTH),
    batch_size=BATCH_SIZE,
    class_mode='binary' # 'binary' for 2 classes (cat or dog)
)

val_data_gen = validation_image_generator.flow_from_directory(
    directory=validation_dir,
    target_size=(IMG_HEIGHT, IMG_WIDTH),
    batch_size=BATCH_SIZE,
    class_mode='binary'
)

# NOTE: For test_data_gen, we must use shuffle=False and class_mode=None
# because the test data directory has no subdirectories (1 class).
test_data_gen = test_image_generator.flow_from_directory(
    directory=test_dir,
    target_size=(IMG_HEIGHT, IMG_WIDTH),
    batch_size=BATCH_SIZE,
    class_mode=None, # Set to None because the test data is unlabeled (no subdirectories)
    shuffle=False # Crucial for matching predictions to expected labels in the test
)
